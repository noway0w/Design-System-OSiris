# Nginx config for OSiris - enables PHP execution
# Your VPS uses nginx (not Apache). Add PHP support:
#
# 1. Copy to nginx: sudo cp osiris-nginx.conf /etc/nginx/conf.d/osiris.conf
# 2. Fix root path below if your project is elsewhere
# 3. Check php-fpm socket: grep '^listen =' /etc/php-fpm.d/www.conf
# 4. Reload: sudo nginx -t && sudo systemctl reload nginx
# 5. Ensure php-fpm runs: sudo systemctl enable --now php-fpm
# 6. Test: curl -s http://127.0.0.1/api/debug-users.php

server {
    listen 80;
    server_name 82.165.170.76 localhost osiris.guillaumelassiat.com;
    root /home/OSiris/public_html;
    index index.html index.php;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ \.php$ {
        try_files $uri =404;
        fastcgi_pass unix:/run/php-fpm/www.sock;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
        fastcgi_param PHP_VALUE "upload_max_filesize=10M \n post_max_size=10M";
        fastcgi_read_timeout 60;
    }
}
